<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Caf√© Albania ‚Äì Aventura, Sabor y Naturaleza</title>
  <meta name="description"
    content="Descubre Caf√© Albania: experiencias de aventura, naturaleza y el aut√©ntico sabor del caf√© en un entorno √∫nico. √önete a nuestra comunidad y vive la experiencia Albania." />
  <meta name="keywords"
    content="Caf√© Albania, caf√©, aventura, naturaleza, turismo, Grupo Albania, experiencias, sabor, eco-turismo" />
  <meta name="author" content="Grupo Albania" />

  <!-- Favicon -->
  <link rel="icon" href="281761965_538131461270982_651536434038609694_n.jpg" type="image/x-icon" />

  <!-- Open Graph (para compartir en Facebook y WhatsApp) -->
  <meta property="og:title" content="Caf√© Albania ‚Äì Aventura, Sabor y Naturaleza" />
  <meta property="og:description"
    content="Vive la experiencia Caf√© Albania: turismo, naturaleza y caf√© de calidad. Descubre nuestras aventuras y sabores √∫nicos." />
  <meta property="og:image" content="https://tusitio.com/imagen-compartir.jpg" />
  <meta property="og:url" content="https://tusitio.com" />
  <meta property="og:type" content="website" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Caf√© Albania ‚Äì Aventura, Sabor y Naturaleza" />
  <meta name="twitter:description" content="Vive la experiencia Caf√© Albania: turismo, naturaleza y caf√© de calidad." />
  <meta name="twitter:image" content="https://tusitio.com/imagen-compartir.jpg" />

  <!-- Fuentes y CSS -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="dise√±o.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://cdn.jsdelivr.net/npm/aos@3.0.0-beta.6/dist/aos.css" rel="stylesheet">
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-dark fixed-top bg-dark bg-opacity-75 backdrop-blur shadow-sm">
    <div class="container">
      <!-- Logo y nombre -->
      <a class="navbar-brand d-flex align-items-center gap-2" href="#" aria-label="Inicio - Caf√© Albania">
        <img src="281761965_538131461270982_651536434038609694_n.jpg" alt="Logo Caf√© Albania" width="40" height="40"
          class="rounded-circle shadow-sm">
        <span class="fs-5 fw-semibold">Caf√© Albania</span>
      </a>

      <!-- Bot√≥n hamburguesa -->
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#menu" aria-controls="menu"
        aria-expanded="false" aria-label="Alternar navegaci√≥n">
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Men√∫ -->
      <div class="collapse navbar-collapse" id="menu">
        <ul class="navbar-nav ms-auto align-items-center gap-3">
          <li class="nav-item"><a class="nav-link fw-medium text-white" href="#aventura">Aventura</a></li>
          <li class="nav-item"><a class="nav-link fw-medium text-white" href="#restaurantes">Restaurantes</a></li>
          <li class="nav-item"><a class="nav-link fw-medium text-white" href="#galeria">Galer√≠a</a></li>
          <li class="nav-item"><a class="nav-link fw-medium text-white" href="#visitanos">Vis√≠tanos</a></li>

          <!-- Selector de idioma -->
          <li class="nav-item">
            <select id="lang-select" class="form-select form-select-sm border-light bg-dark text-white"
              style="min-width:100px;">
              <option value="es">Espa√±ol</option>
              <option value="en">Ingl√©s</option>
              <option value="fr">Franc√©s</option>
            </select>
          </li>

          <!-- Bot√≥n modo oscuro -->
        </ul>
      </div>
    </div>
  </nav>

  </header>

  <section>
    <div class="hero-banner">
      <div id="slides-container"></div>
      <div class="hero-overlay"></div>

      <div class="container">
        <!-- Redes sociales -->
        <div class="hero-col social-col">
          <div class="social-icons">
            <a href="#"><i class="fab fa-facebook-f"></i></a>
            <a href="#"><i class="fab fa-instagram"></i></a>
            <a href="#"><i class="fab fa-linkedin-in"></i></a>
          </div>
        </div>

        <!-- Texto principal -->
        <div class="hero-col text-col" id="hero-text">

        </div>

        <!-- Imagen o video -->
        <div class="hero-col video-col">
          <div class="video-wrapper animated fadeInRight" id="hero-media-wrapper">
            <!-- Aqu√≠ se llenar√° imagen o video -->
          </div>
        </div>
      </div>
    </div>
  </section>
  <br>

  <section>
    <div id="quienes-somos" data-aos="fade-up">
      <!-- Imagen de fondo -->

      <!-- Texto centrado -->
      <div class="container text-col" data-aos="fade-left">
        <div class="img">
          <img src="281761965_538131461270982_651536434038609694_n.jpg" alt="Nuestro equipo">
        </div>
        <h2>Qui√©nes Somos</h2>
        <p>En <strong>Caf√© Albania</strong> combinamos pasi√≥n por el caf√©, naturaleza y aventuras extremas. Nuestro
          objetivo es ofrecerte una experiencia √∫nica, donde cada visita te conecta con la belleza de la Ruta de Las
          Flores y la calidez de nuestra gente.</p>
        <p>Desde nuestros juegos extremos hasta nuestros restaurantes, cuidamos cada detalle para que tu tiempo con
          nosotros sea inolvidable.</p>
        <p class="fw-semibold">¬°Ven y vive la experiencia completa!</p>
        <div class="hero-buttons">
          <a href="#juegos" class="hero-btn">mirar</a>
        </div>
      </div>

    </div>
  </section>


  <br>
  <section>
    <div id="aventura1" class="container-fluid px-5">
      <div class="container text-center">
        <div class="galeria-header mb-5" data-aos="fade-down" id="galeria">
          <h2 class="text-success mb-3">Galer√≠a</h2>
          <p class="text-secondary">
            Descubre las mejores im√°genes de nuestros juegos, restaurantes y experiencias.
          </p>
        </div>

        <div id="galeriaGrid" class="row justify-content-center">
          <!-- Tus elementos de galer√≠a aqu√≠ -->
        </div>
      </div>
    </div>
  </section>


  <br>
  <section>
    <div id="aventura" class="container-fluid px-5">
      <!-- T√≠tulos principales -->
      <h2 class="text-success text-center mb-2" data-aos="fade-down">Juegos Extremos</h2>
      <h3 class="text-center text-secondary mb-4" data-aos="fade-up">Descubre la aventura</h3>
      <p class="text-center text-dark mb-5" data-aos="fade-up" data-aos-delay="100">
        Vive experiencias √∫nicas y aprovecha todos nuestros beneficios para tu diversi√≥n y seguridad.
      </p>

      <!-- Cards de beneficios estilo ticket -->
      <div class="row g-4">
        <div class="col-md-4" data-aos="zoom-in">
          <div class="card card-ticket text-center h-100">
            <div class="icon-circle bg-success text-white mb-3">
              <i class="fas fa-users fa-2x"></i>
            </div>
            <h5 class="card-title mb-2">Grupos y familia</h5>
            <p class="card-text">
              Actividades dise√±adas para compartir momentos inolvidables con amigos y familiares.
            </p>
          </div>
        </div>
        <div class="col-md-4" data-aos="zoom-in" data-aos-delay="100">
          <div class="card card-ticket text-center h-100">
            <div class="icon-circle bg-info text-white mb-3">
              <i class="fas fa-shield-alt fa-2x"></i>
            </div>
            <h5 class="card-title mb-2">Seguridad primero</h5>
            <p class="card-text">
              Supervisi√≥n profesional y protocolos de seguridad en todas las actividades.
            </p>
          </div>
        </div>
        <div class="col-md-4" data-aos="zoom-in" data-aos-delay="200">
          <div class="card card-ticket text-center h-100">
            <div class="icon-circle bg-danger text-white mb-3">
              <i class="fas fa-camera fa-2x"></i>
            </div>
            <h5 class="card-title mb-2">Fotos y recuerdos</h5>
            <p class="card-text">
              Capturamos los mejores momentos para que los lleves contigo.
            </p>
          </div>
        </div>
      </div>

      <!-- Juegos din√°micos estilo tickets -->
      <div class="row g-4 mt-5" id="juegos-container"></div>

      <!-- Modales din√°micos -->
      <div id="modals-container"></div>
    </div>
  </section>

  <section>
    <div class="container" id="restaurantes" class="py-5" data-aos="fade-up" data-aos-duration="1000">
      <h2 class="text-success mb-4" data-aos="fade-right">Restaurantes</h2>
      <div class="row g-4" id="restaurantes-container">
        <!-- Las cards de los restaurantes se generar√°n aqu√≠ din√°micamente -->
      </div>
    </div>

    <!-- Contenedor para los modales de cada restaurante -->
    <div id="modals-restaurantes"></div>
  </section>


  <section>
    <div id="visitanos" class="visitanos-section" data-aos="fade-left">
      <div class="content">
        <h2 data-aos="fade-down" data-aos-duration="1000">Vis√≠tanos</h2>
        <p data-aos="fade-up" data-aos-duration="1000">Caf√© Albania, Ruta de Las Flores, El Salvador</p>
        <div class="visitanos-container">

          <!-- MAPA -->
          <div class="map-container" data-aos="zoom-in" data-aos-duration="1000">
            <iframe
              src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3873.657579834438!2d-89.8082809!3d13.8595812!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8f62bc56d58cc187%3A0xab37b40025ffa8c8!2sCaf%C3%A9%20Albania!5e0!3m2!1ses-419!2ssv!4v1756511791964!5m2!1ses-419!2ssv"
              width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"></iframe>

            <!-- Enlaces para abrir en Google Maps o Waze -->
            <ul class="map-links">
              <li>üó∫Ô∏è <a href="https://www.google.com/maps/dir/?api=1&destination=13.8595812,-89.8082809"
                  target="_blank">Ir en Google Maps</a></li>
              <li>üöó <a href="https://waze.com/ul?ll=13.8595812,-89.8082809&navigate=yes" target="_blank">Ir en Waze</a>
              </li>
            </ul>
          </div>

          <!-- CONTACTO -->
          <div class="contacto" data-aos="fade-left" data-aos-duration="1000">
            <h3>üìå Cont√°ctanos</h3>
            <ul>
              <li>üìû <a href="tel:+50300000000">+503 0000 0000</a></li>
              <li>üí¨ <a href="https://wa.me/50300000000">WhatsApp</a></li>
              <li>‚úâÔ∏è <a href="mailto:hola@cafealbania.com">hola@cafealbania.com</a></li>
              <li>‚è∞ Lunes - Domingo: 8:00 AM - 6:00 PM</li>
            </ul>
          </div>

        </div>
      </div>
    </div>
  </section>


  <section id="google-reviews">
    <h2 class="reviews-title">Rese√±as de nuestros clientes</h2>
    <p class="reviews-desc">
      Nos encanta recibir comentarios de nuestros visitantes. Aqu√≠ puedes ver lo que nuestros clientes opinan sobre Caf√©
      Albania.
      ¬°Tu experiencia tambi√©n puede ser parte de nuestra historia!
    </p>

    <!-- Separador decorativo -->
    <div class="divider"></div>

    <div class="reviews-container">
      <!-- Primer widget Trustindex -->
      <div class="ti-widget">
        <script defer async src="https://cdn.trustindex.io/loader-feed.js?891a271543241295e756498cb02"></script>
        <div trustindex-feed data-widget-id="891a271543241295e756498cb02"></div>
      </div>

      <!-- Tercer widget Trustindex (Feed nuevo) -->
      <div class="ti-widget">
        <script defer async src="https://cdn.trustindex.io/loader.js?5a104a25478712906516f4439d4"></script>
        <div trustindex data-widget-id="5a104a25478712906516f4439d4"></div>
      </div>
    </div>

    <!-- Bot√≥n para ver todas las rese√±as -->
    <a href="https://www.google.com/maps/place/Caf%C3%A9+Albania" target="_blank" class="reviews-btn">Ver todas las
      rese√±as en Google</a>
  </section>

  <footer class="footer">
    <div class="footer-container" data-aos="fade-up" data-aos-delay="200">

      <div class="footer-logo" data-aos="fade-right" data-aos-delay="300">
        <h2>Caf√© Albania</h2>
        <p>Disfruta de la mejor experiencia de caf√©, naturaleza y aventura en un solo lugar.</p>
      </div>

      <div class="footer-contact" data-aos="fade-left" data-aos-delay="400">
        <h3>Contacto</h3>
        <p><a href="https://wa.me/50300000000" target="_blank">WhatsApp</a> |
          <a href="mailto:hola@cafealbania.com">hola@cafealbania.com</a>
        </p>
        <p>üìç <a href="https://goo.gl/maps/example" target="_blank">Apaneca, El Salvador</a></p>
      </div>

      <div class="footer-social" data-aos="fade-up" data-aos-delay="500">
        <h3>S√≠guenos</h3>
        <div class="social-icons-vertical">
          <a href="#" target="_blank" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
          <a href="#" target="_blank" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
          <a href="#" target="_blank" aria-label="TikTok"><i class="fab fa-tiktok"></i></a>
        </div>
      </div>


      <div class="footer-newsletter" data-aos="fade-up" data-aos-delay="600">
        <h3>Suscr√≠bete</h3>
        <p>Recibe promociones y novedades directamente en tu correo.</p>
        <form id="newsletter-form" class="newsletter-form">
          <input type="email" id="newsletter-email" placeholder="Tu correo electr√≥nico" required>
          <button type="submit">Suscribirse</button>
        </form>
        <p id="newsletter-msg" style="color:green; margin-top:0.5rem;"></p>
      </div>

    </div>

    <hr data-aos="fade-up" data-aos-delay="700">

    <div class="footer-bottom" data-aos="fade-up" data-aos-delay="800">
      ¬© <span id="y"></span> Caf√© Albania | Desarrollado por
      <a href="https://cygnus-ti.com/" target="_blank">Cygnus-TI</a>
    </div>
  </footer>


  <!-- Incluye Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/instafeed.js@2.0.0/instafeed.min.js"></script>

  <!-- Bot√≥n flotante de WhatsApp -->

  <a href="#" id="whatsapp-float" style="
     position:fixed; 
     bottom:20px; 
     right:20px; 
     background:#25d366; 
     color:#fff; 
     padding:0.8rem; 
     border-radius:50%; 
     display:flex; 
     align-items:center; 
     justify-content:center; 
     box-shadow:0 4px 10px rgba(0,0,0,0.3); 
     z-index:1000;
     font-size:1.5rem;
     text-decoration:none;
     cursor:pointer;
   ">
    <i class="fab fa-whatsapp"></i>
    <span id="carrito-count" style="
          position:absolute;
          top:-5px;
          right:-5px;
          background:red;
          color:white;
          width:18px;
          height:18px;
          border-radius:50%;
          font-size:12px;
          display:flex;
          align-items:center;
          justify-content:center;
        ">0</span>
  </a>

  <!-- Modal del carrito -->
  <div class="modal fade" id="carritoModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Tu carrito de WhatsApp</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body" id="carrito-list" style="max-height:300px; overflow-y:auto;">
          <!-- Aqu√≠ se llenar√°n los items -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Cerrar</button>
          <button type="button" class="btn btn-success btn-sm" id="enviar-whatsapp-btn">Enviar por WhatsApp</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/ScrollTrigger.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aos@3.0.0-beta.6/dist/aos.js"></script>

  <script>
    const CARRITO_KEY = "carritoWhatsApp";

    // Actualiza el contador del carrito
    function actualizarContador() {
      const carrito = JSON.parse(localStorage.getItem(CARRITO_KEY)) || [];
      document.getElementById("carrito-count").textContent = carrito.length;
    }

    // Agrega un item al carrito
    function agregarAlCarrito(nombre, cantidad = 1, tipo = "Juego") {
      const carrito = JSON.parse(localStorage.getItem(CARRITO_KEY)) || [];
      carrito.push({ nombre, cantidad, tipo });
      localStorage.setItem(CARRITO_KEY, JSON.stringify(carrito));
      actualizarContador();
    }

    // Elimina un item del carrito
    function eliminarDelCarrito(index) {
      const carrito = JSON.parse(localStorage.getItem(CARRITO_KEY)) || [];
      carrito.splice(index, 1); // eliminar el item
      localStorage.setItem(CARRITO_KEY, JSON.stringify(carrito));
      actualizarContador();
      mostrarCarrito(); // refresca el modal
    }

    // Muestra el carrito en el modal
    function mostrarCarrito() {
      const carrito = JSON.parse(localStorage.getItem(CARRITO_KEY)) || [];
      const container = document.getElementById("carrito-list");
      container.innerHTML = "";

      if (!carrito.length) {
        container.innerHTML = "<p>Tu carrito est√° vac√≠o.</p>";
      } else {
        carrito.forEach((item, i) => {
          container.innerHTML += `
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; padding:5px; border-bottom:1px solid #ddd;">
          <span>${item.tipo}: <strong>${item.nombre}</strong> (Cantidad: ${item.cantidad})</span>
          <button class="btn btn-sm btn-danger" onclick="eliminarDelCarrito(${i})">&times;</button>
          
        </div>
      `;
        });
      }

      // Abrir modal
      const carritoModal = new bootstrap.Modal(document.getElementById('carritoModal'));
      carritoModal.show();
    }

    // Enviar carrito por WhatsApp
    function enviarCarritoWhatsApp() {
      const carrito = JSON.parse(localStorage.getItem(CARRITO_KEY)) || [];
      if (!carrito.length) return alert("El carrito est√° vac√≠o.");

      const numero = "50371755007"; // tu n√∫mero de WhatsApp
      const mensaje = carrito.map(item => `Quiero ${item.tipo}: ${item.nombre} (Cantidad: ${item.cantidad})`).join("\n");
      const url = `https://wa.me/${numero}?text=${encodeURIComponent(mensaje)}`;
      window.open(url, "_blank");

      // Limpiar carrito y actualizar contador
      localStorage.removeItem(CARRITO_KEY);
      actualizarContador();

      // Cerrar modal
      const carritoModalEl = document.getElementById('carritoModal');
      const modal = bootstrap.Modal.getInstance(carritoModalEl);
      if (modal) modal.hide();
    }

    // Bot√≥n flotante abre el modal
    document.getElementById("whatsapp-float").addEventListener("click", function (e) {
      e.preventDefault();
      mostrarCarrito();
    });

    // Bot√≥n enviar WhatsApp dentro del modal
    document.getElementById("enviar-whatsapp-btn").addEventListener("click", enviarCarritoWhatsApp);

    // Inicializar contador al cargar la p√°gina
    actualizarContador();

    // Evento para que al cerrar el modal, la p√°gina vuelva a la vista principal
    const carritoModalEl = document.getElementById('carritoModal');
    carritoModalEl.addEventListener('hidden.bs.modal', function () {
      // Scroll suave al top de la p√°gina
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });


    //// ================================================
    // Funciones y l√≥gica principal

    // ------------------- AOS -------------------
    AOS.init({ duration: 1000, easing: 'ease-in-out', once: true });

    // ------------------- A√ëO ACTUAL -------------------
    document.getElementById('y').textContent = new Date().getFullYear();


    // ------------------- LEE EL  XML -------------------
    async function loadConfig() {
      try {
        const res = await fetch('/config.xml'); // Ruta del XML
        const text = await res.text();

        const parser = new DOMParser();
        const xml = parser.parseFromString(text, "application/xml");

        const urlNode = xml.querySelector('baseUrl');
        if (urlNode) {
          BASE_URL = urlNode.textContent.trim();
          console.log("BASE_URL:", BASE_URL); // ‚úÖ Log aqu√≠, despu√©s de asignar
        } else {
          console.warn('No se encontr√≥ <baseUrl> en config.xml');
        }
      } catch (err) {
        console.error('Error cargando config.xml:', err);
      }
    }



    // ------------------- VARIABLES GLOBALES -------------------
    let BASE_URL = ''; // Se leer√° desde config.xml
    let galeria = [], juegos = [], restaurantes = [], currentIndex = 0;

    // ------------------- CARGAR CONFIG -------------------
    async function loadConfig() {
      try {
        const res = await fetch('/config.xml'); // Ruta del XML
        const text = await res.text();

        const parser = new DOMParser();
        const xml = parser.parseFromString(text, "application/xml");

        const urlNode = xml.querySelector('baseUrl');
        if (urlNode) {
          BASE_URL = urlNode.textContent.trim();
        } else {
          console.warn('No se encontr√≥ <baseUrl> en config.xml');
        }
      } catch (err) {
        console.error('Error cargando config.xml:', err);
      }
    }

    // ------------------- HERO BANNER -------------------
    async function initHeroBanner() {
      try {
        const res = await fetch(`${BASE_URL}/api/web/banners`);
        const data = await res.json();
        if (!data.success) return;

        let current = 0;
        fillHeroContent(data.banners[current]);

        // Cambiar banner cada 5 segundos
        setInterval(() => {
          current = (current + 1) % data.banners.length;
          fillHeroContent(data.banners[current]);
        }, 5000);

      } catch (err) {
        console.error('Error cargando banners:', err);
      }
    }

    function fillHeroContent(banner) {
      const textCol = document.getElementById('hero-text');
      textCol.innerHTML = `
    <h2 class="animated fadeIn">${banner.titulo}</h2>
    <div class="animated fadeIn delay-1">${banner.descripcion_corta}</div>
    <div class="hero-buttons">
      ${banner.link ? `<a href="${banner.link}" class="hero-btn animated fadeIn delay-2">Ver m√°s</a>` : ''}
      <a href="#aventura" class="hero-btn animated fadeIn delay-2">Conocer m√°s</a>
    </div>
  `;

      const mediaWrapper = document.getElementById('hero-media-wrapper');
      mediaWrapper.innerHTML = '';

      if (banner.video) {
        const iframe = document.createElement('iframe');
        iframe.src = banner.video;
        iframe.frameBorder = 0;
        iframe.allowFullscreen = true;
        iframe.className = 'hero-video';
        mediaWrapper.appendChild(iframe);
      } else if (banner.imagen) {
        let imgUrl = '';
        try {
          const imgs = JSON.parse(banner.imagen);
          if (Array.isArray(imgs) && imgs.length) imgUrl = imgs[0];
        } catch { imgUrl = ''; }

        if (imgUrl) {
          const img = document.createElement('img');
          img.src = imgUrl;
          img.className = 'hero-image';
          mediaWrapper.appendChild(img);
        }
      }
    }

    // ------------------- UTILIDADES -------------------
    function parseImagenes(imagenes) {
      if (Array.isArray(imagenes)) return imagenes;
      if (typeof imagenes === 'string') return imagenes.split(',').map(img => img.trim());
      return [];
    }

    function renderMedia(url, alt = '', responsive = false) {
      const ext = url.split('.').pop().toLowerCase();
      if (['mp4', 'webm', 'ogg'].includes(ext)) {
        return `<video class="d-block w-100 ${responsive ? 'img-fluid' : ''}" controls>
              <source src="${url}" type="video/${ext}">
              Tu navegador no soporta video.
            </video>`;
      } else {
        return `<img src="${url}" alt="${alt}" class="d-block w-100 ${responsive ? 'img-fluid' : ''}">`;
      }
    }

    // ------------------- JUEGOS -------------------
    async function fetchJuegos() {
      try {
        const res = await fetch(`${BASE_URL}/api/juegos`);
        const data = await res.json();
        juegos = Array.isArray(data.data) ? data.data : [];
        renderJuegos();
      } catch (e) {
        console.error("Error cargando juegos:", e);
      }
    }

    function renderJuegos() {
      const container = document.getElementById("juegos-container");
      container.innerHTML = "";

      juegos.forEach((juego, i) => {
        const imagenes = parseImagenes(juego.imagenes || juego.imagen);

        container.innerHTML += `
      <div class="col-md-4 mb-4" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="${i * 150}">
        <div class="card-ticket shadow-sm h-100">
          <div id="carouselJuegoCard${i}" class="carousel slide position-relative" data-bs-ride="carousel" style="height: 250px;">
            <div class="carousel-inner h-100">
              ${imagenes.map((img, idx) => `
                <div class="carousel-item ${idx === 0 ? 'active' : ''}" 
                     data-bs-toggle="modal" 
                     data-bs-target="#juegoModal${i}" 
                     style="cursor:pointer; position:relative; height:100%;">
                  ${renderMedia(img, juego.nombre, true)}
                  <div class="overlay-ticket">
                    <span>${juego.nombre}</span>
                    <span class="icons">
                      <i class="fas fa-mountain"></i>
                      <i class="fas fa-bolt"></i>
                      <i class="fas fa-hiking"></i>
                    </span>
                  </div>
                </div>
              `).join('')}
            </div>
          </div>

          <!-- Modal del juego -->
          <div class="modal fade" id="juegoModal${i}" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered modal-lg">
              <div class="modal-content">
                <div class="modal-header p-2">
                  <h5 class="modal-title">${juego.nombre}</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-2">
                  <div id="carouselJuego${i}" class="carousel slide mb-3" data-bs-ride="carousel">
                    <div class="carousel-inner">
                      ${imagenes.map((img, idx) => `
                        <div class="carousel-item ${idx === 0 ? 'active' : ''}">
                          ${renderMedia(img, juego.nombre, true)}
                        </div>
                      `).join('')}
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#carouselJuego${i}" data-bs-slide="prev">
                      <span class="carousel-control-prev-icon"></span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#carouselJuego${i}" data-bs-slide="next">
                      <span class="carousel-control-next-icon"></span>
                    </button>
                  </div>

                  <p class="mb-2"><strong>Precio:</strong> ${juego.precio ? '$' + juego.precio : 'Consultar'}</p>
                  <p class="mb-2"><strong>Duraci√≥n:</strong> ${juego.duracion || 'N/A'}</p>
                  <p class="text-muted">${juego.descripcion_larga || "Pr√≥ximamente m√°s informaci√≥n."}</p>
                </div>
                <div class="modal-footer p-2">
                  <button class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Cerrar</button>
                  <button class="btn btn-success btn-sm" onclick="agregarAlCarrito('${juego.nombre}', 1, 'Juego')">
                    <i class="fas fa-cart-plus"></i> Agregar al carrito
                  </button>
                </div>
              </div>
            </div>
          </div>
          <!-- Fin modal -->
        </div>
      </div>
    `;
      });

      if (typeof AOS !== 'undefined') AOS.init({ once: true });
    }

    // ------------------- RESTAURANTES -------------------
    async function fetchRestaurantes() {
      try {
        const res = await fetch(`${BASE_URL}/api/restaurantes`);
        const data = await res.json();
        console.log("Datos de restaurantes:", data); // Log para depuraci√≥n
        restaurantes = Array.isArray(data.restaurantes)
          ? data.restaurantes.map(r => ({ ...r, imagenes: parseImagenes(r.imagenes || r.imagen) }))
          : [];
        renderRestaurantes();
      } catch (e) {
        console.error("Error cargando restaurantes:", e);
      }
    }

    function renderRestaurantes() {
      const container = document.getElementById("restaurantes-container");
      const modalsContainer = document.getElementById("modals-restaurantes");
      container.innerHTML = "";
      modalsContainer.innerHTML = "";

      restaurantes.forEach((rest, i) => {
        container.innerHTML += `
      <div class="col-md-6 mb-4" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="${i * 200}">
        <div class="card restaurante-card shadow-lg border-0 rounded-4 overflow-hidden position-relative">
          <span class="rest-badge">${rest.categoria || 'Restaurante'}</span>
          <div id="carouselCard${i}" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner rounded-top">
              ${rest.imagenes.map((img, idx) => `<div class="carousel-item ${idx === 0 ? 'active' : ''}">${renderMedia(img, rest.nombre, true)}</div>`).join('')}
            </div>
          </div>
          <div class="card-body d-flex flex-column p-4">
            <h5 class="card-title fw-bold text-success">${rest.nombre}</h5>
            <p class="card-text text-muted mb-3">${rest.descripcion_corta || 'Restaurante con excelente comida'}</p>
            <button class="btn btn-gradient mt-auto" data-bs-toggle="modal" data-bs-target="#restModal${i}">Ver m√°s</button>
          </div>
        </div>
      </div>
    `;

        modalsContainer.innerHTML += `
      <div class="modal fade" id="restModal${i}" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
          <div class="modal-content modal-glass rounded-4 border-0 shadow-lg">
            <div class="modal-header border-0 p-3">
              <h5 class="modal-title fw-bold text-success">${rest.nombre} - Men√∫</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-3">
              <p>${rest.descripcion_larga || 'Pr√≥ximamente m√°s detalles del restaurante.'}</p>
              <div id="carouselRest${i}" class="carousel slide mb-3" data-bs-ride="carousel">
                <div class="carousel-inner rounded">
                  ${rest.imagenes.map((img, idx) => `<div class="carousel-item ${idx === 0 ? 'active' : ''}">${renderMedia(img, rest.nombre, true)}</div>`).join('')}
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#carouselRest${i}" data-bs-slide="prev">
                  <span class="carousel-control-prev-icon"></span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carouselRest${i}" data-bs-slide="next">
                  <span class="carousel-control-next-icon"></span>
                </button>
              </div>
            </div>
            <div class="modal-footer border-0 p-3">
              <button class="btn btn-gradient-outline" data-bs-dismiss="modal">Cerrar</button>
            </div>
          </div>
        </div>
      </div>
    `;
      });
    }


    // ------------------- GALER√çA -------------------
    const galeriaGrid = document.getElementById("galeriaGrid");

    async function cargarGaleria() {
      if (!galeriaGrid) return;

      galeriaGrid.innerHTML = "";

      const endpoints = [
        { url: `${BASE_URL}/api/web/banners`, tipo: "banners" },
        { url: `${BASE_URL}/api/juegos`, tipo: "juegos" },
        { url: `${BASE_URL}/api/restaurantes`, tipo: "restaurantes" }
      ];

      let todasImagenes = [];

      for (let { url, tipo } of endpoints) {
        try {
          const res = await fetch(url);
          if (!res.ok) continue;
          const data = await res.json();
          let imagenes = [];

          if (tipo === "banners" && data.banners) {
            data.banners.forEach(b => {
              if (b.imagen) {
                try {
                  const parsed = JSON.parse(b.imagen);
                  if (Array.isArray(parsed)) imagenes.push(...parsed);
                } catch { }
              }
            });
          } else if (tipo === "juegos" && data.data) {
            data.data.forEach(j => {
              if (j.imagenes && Array.isArray(j.imagenes)) imagenes.push(...j.imagenes);
            });
          } else if (tipo === "restaurantes" && data.restaurantes) {
            data.restaurantes.forEach(r => {
              if (r.imagen) {
                try {
                  const parsed = JSON.parse(r.imagen);
                  if (Array.isArray(parsed)) imagenes.push(...parsed);
                } catch { }
              }
              if (r.imagenes && Array.isArray(r.imagenes)) imagenes.push(...r.imagenes);
            });
          }

          if (imagenes.length > 3) imagenes = imagenes.slice(0, 3);
          todasImagenes.push(...imagenes);

        } catch (err) {
          console.error(`Error cargando im√°genes desde ${url}:`, err);
        }
      }

      if (todasImagenes.length === 0) return;

      // Crear la fila principal
      const rowDiv = document.createElement("div");
      rowDiv.className = "row";

      // N√∫mero de columnas (3)
      const columnas = [document.createElement("div"), document.createElement("div"), document.createElement("div")];
      columnas.forEach(col => {
        col.className = "col-lg-4 col-md-12 mb-4 mb-lg-0";
        rowDiv.appendChild(col);
      });

      // Distribuir im√°genes por columna
      todasImagenes.forEach((urlImg, index) => {
        const colIndex = index % 3; // va rotando: 0,1,2
        const img = document.createElement("img");
        img.src = urlImg;
        img.alt = `Galer√≠a ${index + 1}`;
        img.className = "w-100 shadow-1-strong rounded mb-4";
        img.loading = "lazy";
        columnas[colIndex].appendChild(img);
      });

      galeriaGrid.appendChild(rowDiv);

      // Inicializar Lightbox
      if (typeof mdb !== "undefined" && mdb.Lightbox) mdb.Lightbox.init();
    }

    document.addEventListener("DOMContentLoaded", cargarGaleria);

    // ------------------- INICIALIZACI√ìN -------------------
    async function init() {
      await loadConfig();
      initHeroBanner();
      fetchJuegos();
      fetchRestaurantes();
      cargarGaleria();

    }

    init();
    // ================================
    const LANG_KEY = 'idioma-pagina';
    const traduccionesCache = new Map();

    // ================================
    // Funci√≥n para traducir texto con cache
    // ================================
    async function traducirTextoGoogle(texto, target = 'es') {
      if (!texto.trim()) return texto;
      const key = `${texto}::${target}`;
      if (traduccionesCache.has(key)) return traduccionesCache.get(key);
      try {
        const url = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=${target}&dt=t&q=${encodeURIComponent(texto)}`;
        const res = await fetch(url);
        const data = await res.json();
        const traducido = data[0].map(d => d[0]).join('');
        traduccionesCache.set(key, traducido);
        return traducido;
      } catch (e) {
        console.error('Error traduciendo:', texto, e);
        return texto;
      }
    }

    // ================================
    // Funci√≥n recursiva para traducir todos los nodos
    // ================================
    async function traducirNodo(el, target) {
      const nodos = [];

      function extraerNodos(node) {
        if (node.nodeType === Node.TEXT_NODE && node.textContent.trim()) {
          nodos.push(node);
        } else if (node.nodeType === Node.ELEMENT_NODE) {
          // Inputs, textareas y selects
          if (node.tagName === 'INPUT' || node.tagName === 'TEXTAREA') {
            if (node.placeholder) nodos.push({ tipo: 'placeholder', el: node });
            if (node.value) nodos.push({ tipo: 'value', el: node });
          }
          if (node.tagName === 'SELECT') {
            for (let option of node.options) nodos.push({ tipo: 'option', el: option });
          }
          node.childNodes.forEach(child => extraerNodos(child));
        }
      }

      extraerNodos(el);

      await Promise.all(
        nodos.map(async n => {
          if (n instanceof Text) {
            n.textContent = await traducirTextoGoogle(n.textContent, target);
          } else if (n.tipo === 'placeholder') {
            n.el.placeholder = await traducirTextoGoogle(n.el.placeholder, target);
          } else if (n.tipo === 'value') {
            n.el.value = await traducirTextoGoogle(n.el.value, target);
          } else if (n.tipo === 'option') {
            n.el.text = await traducirTextoGoogle(n.el.text, target);
          }
        })
      );
    }

    // ================================
    // Traducir toda la p√°gina
    // ================================
    async function traducirPagina(target = 'es') {
      await traducirNodo(document.body, target);
    }

    // ================================
    // Cambiar idioma con recarga
    // ================================
    function cambiarIdiomaConRecarga(target) {
      localStorage.setItem(LANG_KEY, target);
      location.reload(); // recarga para traducir todo desde el inicio
    }

    // ================================
    // Selector de idioma
    // ================================
    const select = document.getElementById('lang-select');
    if (select) {
      const langGuardado = localStorage.getItem(LANG_KEY);
      if (langGuardado) select.value = langGuardado;

      select.addEventListener('change', function () {
        cambiarIdiomaConRecarga(this.value);
      });
    }

    // ================================
    // Observador para contenido din√°mico
    // ================================
    const observer = new MutationObserver(async mutations => {
      const lang = localStorage.getItem(LANG_KEY) || 'es';
      const nodosNuevos = [];

      for (let m of mutations) {
        if (m.addedNodes.length > 0) {
          m.addedNodes.forEach(node => {
            if (node.nodeType === 1) nodosNuevos.push(node);
          });
        }
      }

      if (nodosNuevos.length > 0) {
        await Promise.all(nodosNuevos.map(node => traducirNodo(node, lang)));
      }
    });
    observer.observe(document.body, { childList: true, subtree: true });

    // ================================
    // Traducci√≥n autom√°tica al cargar
    // ================================
    window.addEventListener('load', async () => {
      const lang = localStorage.getItem(LANG_KEY) || 'es';
      if (select) select.value = lang;

      // Traducir TODO el contenido est√°tico, incluyendo <h1-h6> como tus <h2>
      if (lang !== 'es') {
        await traducirPagina(lang);
      }
    });




  </script>


</body>

</html>